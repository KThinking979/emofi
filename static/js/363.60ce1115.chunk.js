"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[363],{70712:(e,a,t)=>{t.d(a,{kg:()=>c,Y_:()=>r,wz:()=>i,yg:()=>u,Up:()=>p,uI:()=>l,lC:()=>m,TK:()=>d});var s=t(66220);const n=(0,t(90815).Wp)({apiKey:"AIzaSyDObaXpbUavftTDCAhFmn23akCVpB4cH80",authDomain:"emofi-899d2.firebaseapp.com",projectId:"emofi-899d2",storageBucket:"emofi-899d2.appspot.com",messagingSenderId:"1099226012033",appId:"1:1099226012033:web:2f45b63625daf850bc7080",measurementId:"G-JLXM3H2L66"}),o=(0,s.aU)(n),r=async()=>{try{let e;const a=(0,s.H9)(o,"configs","configs"),t=await(0,s.x7)(a);return t.exists()&&(e=t.data()),e}catch(e){console.error("Error getUser: ",e)}},c=async e=>{let{id:a,username:t,emoFiCoins:n}=e;try{const e=(new Date).toISOString().slice(0,10).replace("-","").replace("-","");await(0,s.BN)((0,s.H9)(o,"users","".concat(a)),{id:"".concat(a),username:t,emoFiCoins:n,scores:0,bestGoal:0,numAds:1,language:"en",faceEmo:"S0",emojis:["S0"],anys:[],skills:[],cards:[],expDateAds:e,createdAt:new Date,updateAt:new Date})}catch(r){console.error("Error createUser: ",r)}},i=async e=>{try{let a;const t=(0,s.H9)(o,"users","".concat(e)),n=await(0,s.x7)(t);return n.exists()&&(a=n.data()),a}catch(a){console.error("Error getUser: ",a)}},d=async e=>{let{id:a,coins:t,scores:n,bestGoal:r,faceEmo:c,numAds:i,expDateAds:d,numClaimDay:l,transactionId:u}=e;try{let e={};null!==t&&void 0!==t&&(e={...e,emoFiCoins:t}),null!==n&&void 0!==n&&(e={...e,scores:n}),null!==r&&void 0!==r&&(e={...e,bestGoal:r}),null!==i&&void 0!==i&&(e={...e,numAds:i}),null!==d&&void 0!==d&&(e={...e,expDateAds:d}),null!==l&&void 0!==l&&(e={...e,numClaimDay:l}),c&&(e={...e,faceEmo:c}),u&&(e={...e,transactionId:u,updateAtTrans:"PAY_".concat(new Date)}),await(0,s.mZ)((0,s.H9)(o,"users","".concat(a)),{...e,updateAt:new Date})}catch(m){console.error("Error updateCoinsUser: ",m)}},l=async e=>{let{id:a,emojis:t}=e;try{await(0,s.mZ)((0,s.H9)(o,"users","".concat(a)),{emojis:t,updateAt:new Date})}catch(n){console.error("Error updateCoinsUser: ",n)}},u=async e=>{let{id:a,anys:t}=e;try{await(0,s.mZ)((0,s.H9)(o,"users","".concat(a)),{anys:t,updateAt:new Date})}catch(n){console.error("Error updateCoinsUser: ",n)}},m=async e=>{let{id:a,skills:t}=e;try{await(0,s.mZ)((0,s.H9)(o,"users","".concat(a)),{skills:t,updateAt:new Date})}catch(n){console.error("Error updateCoinsUser: ",n)}},p=async e=>{let{id:a,cards:t}=e;try{await(0,s.mZ)((0,s.H9)(o,"users","".concat(a)),{cards:t,updateAt:new Date})}catch(n){console.error("Error updateCoinsUser: ",n)}}},10363:(e,a,t)=>{t.r(a),t.d(a,{HomePage:()=>d});var s=t(9950),n=t(63247);const o=(0,t(24451).j)((()=>Promise.all([t.e(96),t.e(373),t.e(660),t.e(360),t.e(730)]).then(t.bind(t,10730))),(e=>e.Play));var r=t(22238),c=t(70712),i=t(44414);function d(){const{user:e}=s.useContext(r.j8),{setUser:a,setConfigs:t}=s.useContext(r.LN),[d,l]=s.useState(!1);(0,s.useEffect)((()=>{window.scrollTo(0,0),u()}),[]);const u=async()=>{var s;const n=await(0,c.Y_)();t(n);const o=null===(s=window.Telegram)||void 0===s?void 0:s.WebApp;if(o&&!e){o.ready();const e=o.initDataUnsafe.user;if(e){let t={id:e.id,username:"".concat(e.last_name," ").concat(e.first_name),emoFiCoins:0};const s=await(0,c.wz)(t.id);s?t={...s,username:"".concat(e.last_name," ").concat(e.first_name)}:await(0,c.kg)(t),a(t)}if(n.isTest){let e={id:"1",username:"Kai Pham",emoFiCoins:0};const t=await(0,c.wz)(e.id);t?e={...t}:await(0,c.kg)(e),a(e)}}l(!0)};return(0,i.jsx)(n.az,{id:"myCanvasContainer",children:d&&(0,i.jsx)(o,{})})}}}]);